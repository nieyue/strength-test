webpackJsonp([2],{b1KW:function(t,e,i){"use strict";var o={name:"TopBar",created:function(){this.routerPath=this.$route.path,(this.routerPath.indexOf("/main")>-1||this.routerPath.indexOf("/login")>-1||this.routerPath.indexOf("/register")>-1)&&this.getIslogin(),this.getConfig()},watch:{},data:function(){return{routerPath:this.$route.path,islogin:!1,account:{},isCollapsed:!1,config:{}}},computed:{rotateIcon:function(){return["menu-icon",this.isCollapsed?"rotate-icon":""]},topbarWidth:function(){return this.isCollapsed?"76px":"260px"},titleFontSize:function(){return this.isCollapsed?"0rem":"2rem"},titleMarginLeft:function(){return this.isCollapsed?"0.2rem":"2rem"}},methods:{collapsedSider:function(){this.isCollapsed=!this.isCollapsed,this.Hub.$emit("isCollapsed",this.isCollapsed)},gologinpage:function(){this.$router.push("/login")},getConfig:function(){var t=this;this.axios({method:"get",url:"/config/list",withCredentials:!0}).then(function(e){200==e.data.code&&(t.config=e.data.data[0],document.querySelector("title").innerText=t.config.platformName)}).catch(function(t){})},loginout:function(){var t=this;this.$Modal.confirm({title:"退出登陆？",content:"<p>确定退出登陆吗？</p>",onOk:function(){t.axios({method:"post",url:"/account/loginout?accountId="+t.business.getAccount().accountId,withCredentials:!0}).then(function(e){console.log(e),200==e.data.code?(t.islogin=!0,sessionStorage.clear(),t.$emit("islogin",t.islogin),t.$Message.success("退出成功！"),t.$router.push("/login")):(t.$emit("islogin",t.islogin),t.$Message.error("失败"))}).catch(function(e){t.$Message.error("系统异常")})},onCancel:function(){t.$Message.success("取消成功！")}})},getIslogin:function(){var t=this;if(!sessionStorage.getItem("account"))return sessionStorage.clear(),this.$emit("islogin",this.islogin),void((this.routerPath.indexOf("/main")>-1||this.routerPath.indexOf("/login")>-1)&&this.$nextTick(function(){t.$router.push("/login")}));this.axios({method:"post",url:"/account/islogin",withCredentials:!0}).then(function(e){console.log(e),200==e.data.code?(t.islogin=!0,t.account=e.data.data[0],t.$emit("islogin",t.islogin)):(sessionStorage.clear(),t.$emit("islogin",t.islogin),t.$router.push("/login"),t.$Message.info("请登录"))}).catch(function(e){t.$Message.error("系统异常")})}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"topbar"},[i("div",{staticClass:"topbar-left",style:{width:t.topbarWidth}},[i("span",{staticClass:"topbar-left-title",staticStyle:{"font-size":"2rem","line-height":"6rem","margin-left":"2rem"},style:{fontSize:t.titleFontSize,marginLeft:t.titleMarginLeft},domProps:{textContent:t._s(t.config.platformName||"")}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.account.accountId,expression:"account.accountId"}],staticStyle:{display:"inline-block",height:"82px","vertical-align":"top","line-height":"82px"}},[i("Icon",{class:t.rotateIcon,style:{margin:"0 20px"},attrs:{type:"md-menu",size:"50"},nativeOn:{click:function(e){return t.collapsedSider(e)}}})],1),t._v(" "),t.islogin?i("div",{staticClass:"topbar-right"},[i("span",{staticClass:"topbar-right-logintext",staticStyle:{color:"#ccc"},domProps:{textContent:t._s(t.account.realname||t.account.nickname||t.account.phone)}}),t._v(" "),i("Button",{staticClass:"topbar-right-loginout",attrs:{type:"text"},on:{click:t.loginout}},[t._v("退出")])],1):t._e()])},staticRenderFns:[]};var a=i("VU/8")(o,n,!1,function(t){i("foFE")},null,null);e.a=a.exports},dcjC:function(t,e){},foFE:function(t,e){},"g0T/":function(t,e){},xJsL:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("mvHQ"),n=i.n(o),a=i("b1KW"),s={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"footer-bar"},[i("div",{staticClass:"footer-bar-wrap"},[i("div",{staticClass:"footer-bar-line-wrap"},[i("span",{staticClass:"footer-bar-link"},[t._v("友情链接：")]),t._v(" "),i("a",{staticClass:"footer-bar-link",attrs:{href:"https://mp.weixin.qq.com/"}},[t._v("微信公众平台")]),t._v(" "),i("a",{staticClass:"footer-bar-link",attrs:{href:"https://wx.qq.com/"}},[t._v("微信网页版")]),t._v(" "),i("a",{staticClass:"footer-bar-link",attrs:{href:"http://weixin.sogou.com/"}},[t._v("搜狗微信")]),t._v(" "),i("a",{staticClass:"footer-bar-link",attrs:{href:"https://baijia.baidu.com/"}},[t._v("百度百家")]),t._v(" "),i("a",{staticClass:"footer-bar-link",attrs:{href:"https://om.qq.com/userAuth/index"}},[t._v("企鹅号")]),t._v(" "),i("a",{staticClass:"footer-bar-link",attrs:{href:"https://weibo.com/"}},[t._v("新浪微博")])]),t._v(" "),i("div",{staticClass:"footer-bar-line-wrap"},[i("div",[t._v("Copyright © 2018")])])])])}]};var r=i("VU/8")({name:"FooterBar",created:function(){},data:function(){return{}},methods:{}},s,!1,function(t){i("dcjC")},null,null).exports,c={name:"Login",components:{TopBar:a.a,FooterBar:r},created:function(){},data:function(){return{account:{adminName:"",password:"",verificationCode:""},islogin:!1,verificationCode:"",loading:!1,loginAccountRules:{adminName:[{required:!0,message:"请输入手机号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],verificationCode:[{required:!0,message:"请输入验证码",trigger:"blur"}]}}},methods:{getVerificationCode:function(){var t=this;this.axios({method:"post",url:"/tool/getVerificationCode",withCredentials:!0,responseType:"blob"}).then(function(e){var i=new Blob([e.data],{type:"image/png"});t.verificationCode=window.URL.createObjectURL(i)}).catch(function(e){t.$Message.error("错误")})},login:function(t){var e=this;this.$refs[t].validate(function(t){console.log("123"),t?(e.loading=!0,e.axios({method:"post",url:"/account/login",withCredentials:!0,data:e.Qs.stringify(e.account)}).then(function(t){console.log(t),e.loading=!1,200==t.data.code?(e.$Message.success(t.data.msg),console.log(t.data.data[0]),sessionStorage.setItem("account",n()(t.data.data[0].account)),sessionStorage.setItem("role",n()(t.data.data[0].role)),sessionStorage.setItem("rolePermissionList",n()(t.data.data[0].rolePermissionList)),e.$router.push("/main/welcome/"+n()(e.pathParams))):(e.$Message.error(t.data.msg),e.loading=!1)}).catch(function(t){e.loading=!1,e.$Message.error("系统异常")})):e.$Message.error("用户名和密码是必填项")})},getIslogin:function(t){this.islogin=t,t?this.$router.push("/main/welcome/"+n()(this.pathParams)):this.getVerificationCode()}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("top-bar",{on:{islogin:t.getIslogin}}),t._v(" "),i("div",{staticClass:"login-wrap",staticStyle:{background:"url('./static/banner1.png') no-repeat"}},[i("Form",{ref:"account",staticClass:"login-account",attrs:{"label-width":0,model:t.account,rules:t.loginAccountRules}},[i("FormItem",{staticClass:"login-account-inputwrap",attrs:{prop:"adminName"}},[i("Input",{staticClass:"login-account-input",attrs:{type:"text",size:"large",placeholder:"输入手机号"},model:{value:t.account.adminName,callback:function(e){t.$set(t.account,"adminName",e)},expression:"account.adminName"}},[i("Icon",{attrs:{slot:"prefix",type:"ios-phone-portrait"},slot:"prefix"})],1)],1),t._v(" "),i("FormItem",{staticClass:"login-account-inputwrap",attrs:{prop:"password"}},[i("Input",{staticClass:"login-account-input",attrs:{type:"password",placeholder:"密码"},model:{value:t.account.password,callback:function(e){t.$set(t.account,"password",e)},expression:"account.password"}},[i("Icon",{attrs:{slot:"prefix",type:"ios-lock-outline"},slot:"prefix"})],1)],1),t._v(" "),i("FormItem",{staticClass:"login-account-inputwrap",attrs:{prop:"verificationCode"}},[i("Input",{staticClass:"login-account-input50",attrs:{type:"text",size:"large",placeholder:"验证码"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.login("account")}},model:{value:t.account.verificationCode,callback:function(e){t.$set(t.account,"verificationCode",e)},expression:"account.verificationCode"}},[i("Icon",{attrs:{slot:"prefix",type:"ios-image-outline"},slot:"prefix"})],1),t._v(" "),i("div",{staticClass:"login-account-input50"},[i("img",{staticStyle:{height:"50px","vertical-align":"middle"},attrs:{src:t.verificationCode},on:{click:function(e){t.getVerificationCode()}}})])],1),t._v(" "),i("Button",{staticClass:"login-account-inputwrap",attrs:{type:"primary",long:""}},[t.loading?i("span",[t._v("Loading...")]):i("span",{staticStyle:{width:"100%",display:"inline-block","font-size":"1.2rem"},on:{click:function(e){t.login("account")}}},[t._v("登录")])])],1)],1),t._v(" "),i("footer-bar")],1)},staticRenderFns:[]};var u=i("VU/8")(c,l,!1,function(t){i("g0T/")},null,null);e.default=u.exports}});
//# sourceMappingURL=2.1cca6ad0d6d0608fcad8.js.map