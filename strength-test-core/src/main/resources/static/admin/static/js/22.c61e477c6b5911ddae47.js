webpackJsonp([22],{aJsH:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"body-wrap"},[a("div",{staticClass:"body-btn-wrap"},[a("Button",{attrs:{type:"primary"},on:{click:t.add}},[t._v("增加账户")]),t._v(" "),a("div",{staticClass:"search-wrap"},[a("Select",{staticClass:"search-wrap-input",attrs:{transfer:""},model:{value:t.params.roleId,callback:function(e){t.$set(t.params,"roleId",e)},expression:"params.roleId"}},t._l(t.roleList,function(e){return a("Option",{key:e.roleId,attrs:{value:e.roleId}},[t._v(t._s(e.name))])})),t._v(" "),a("Select",{staticClass:"search-wrap-input",attrs:{transfer:"",placeholder:"状态，全部"},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}},t._l(t.statusParamsList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.value))])})),t._v(" "),a("Button",{attrs:{type:"info"},on:{click:t.search}},[t._v("查询")])],1)],1),t._v(" "),a("Modal",{attrs:{title:"新增账户管理",closable:!1,"mask-closable":!1,width:"1000px"},model:{value:t.addAccountModel,callback:function(e){t.addAccountModel=e},expression:"addAccountModel"}},[a("Form",{ref:"addAccount",attrs:{model:t.addAccount,"label-width":100,"label-position":"right",rules:t.addAccountRules}},[a("FormItem",{attrs:{prop:"phone",label:"注册手机号:"}},[a("Input",{attrs:{type:"text",placeholder:"注册手机号"},model:{value:t.addAccount.phone,callback:function(e){t.$set(t.addAccount,"phone",e)},expression:"addAccount.phone"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"password",label:"密码:"}},[a("Input",{attrs:{type:"password",placeholder:"密码"},model:{value:t.addAccount.password,callback:function(e){t.$set(t.addAccount,"password",e)},expression:"addAccount.password"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"realname",label:"姓名:"}},[a("Input",{attrs:{type:"text",placeholder:"姓名"},model:{value:t.addAccount.realname,callback:function(e){t.$set(t.addAccount,"realname",e)},expression:"addAccount.realname"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"status",label:"状态:"}},[a("Select",{staticStyle:{width:"100px"},attrs:{transfer:"",size:"large"},model:{value:t.addAccount.status,callback:function(e){t.$set(t.addAccount,"status",e)},expression:"addAccount.status"}},t._l(t.statusList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.value))])}))],1),t._v(" "),a("FormItem",{attrs:{prop:"roleId",label:"角色:"}},[a("Select",{staticStyle:{width:"100px"},attrs:{transfer:"",size:"large"},model:{value:t.addAccount.roleId,callback:function(e){t.$set(t.addAccount,"roleId",e)},expression:"addAccount.roleId"}},t._l(t.roleList,function(e){return a("Option",{key:e.roleId,attrs:{value:e.roleId}},[t._v(t._s(e.name))])}))],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:t.addCancel}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",loading:t.addLoading}},[t.addLoading?a("span",[t._v("Loading...")]):a("span",{on:{click:t.addSure}},[t._v("确定")])])],1)],1),t._v(" "),a("Modal",{attrs:{title:"修改账户管理",closable:!1,"mask-closable":!1,width:"1000px"},model:{value:t.updateAccountModel,callback:function(e){t.updateAccountModel=e},expression:"updateAccountModel"}},[a("Form",{ref:"updateAccount",attrs:{model:t.updateAccount,"label-width":100,"label-position":"right",rules:t.updateAccountRules}},[a("FormItem",{attrs:{prop:"phone",label:"注册手机号:"}},[a("Input",{attrs:{type:"text",placeholder:"注册手机号"},model:{value:t.updateAccount.phone,callback:function(e){t.$set(t.updateAccount,"phone",e)},expression:"updateAccount.phone"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"realname",label:"姓名:"}},[a("Input",{attrs:{type:"text",placeholder:"姓名"},model:{value:t.updateAccount.realname,callback:function(e){t.$set(t.updateAccount,"realname",e)},expression:"updateAccount.realname"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"status",label:"状态:"}},[a("Select",{staticStyle:{width:"100px"},attrs:{transfer:"",size:"large"},model:{value:t.updateAccount.status,callback:function(e){t.$set(t.updateAccount,"status",e)},expression:"updateAccount.status"}},t._l(t.statusList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.value))])}))],1),t._v(" "),a("FormItem",{attrs:{prop:"roleId",label:"角色:"}},[a("Select",{staticStyle:{width:"100px"},attrs:{transfer:"",size:"large"},model:{value:t.updateAccount.roleId,callback:function(e){t.$set(t.updateAccount,"roleId",e)},expression:"updateAccount.roleId"}},t._l(t.roleList,function(e){return a("Option",{key:e.roleId,attrs:{value:e.roleId}},[t._v(t._s(e.name))])}))],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:t.updateCancel}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",loading:t.updateLoading}},[t.updateLoading?a("span",[t._v("Loading...")]):a("span",{on:{click:t.updateSure}},[t._v("确定")])])],1)],1),t._v(" "),a("Table",{ref:"table",attrs:{border:"",height:"500",columns:t.accountColumns,data:t.accountList,size:"small"}}),t._v(" "),a("div",{staticStyle:{display:"inline-block",float:"right","margin-top":"10px"}},[a("Page",{ref:"page",staticStyle:{"margin-right":"10px"},attrs:{"show-sizer":"",pageSize:t.params.pageSize,"page-size-opts":t.params.pageSizeOpts,current:t.params.currentPage,total:t.params.total,"show-total":!0,"show-elevator":""},on:{"on-page-size-change":t.onPageSizeChange,"on-change":t.selectPage}})],1)],1)},staticRenderFns:[]},n=a("VU/8")({name:"ManagerAccount",data:function(){var t=this;return{routerPath:this.$route.path,params:{pageSizeOpts:[10,20,50,100,500,1e3],startNum:1,currentPage:1,pageNum:1,pageSize:10,total:0},statusParamsList:[{id:"",value:"全部"},{id:1,value:"正常"},{id:2,value:"已禁用"}],statusList:[{id:1,value:"正常"},{id:2,value:"已禁用"}],addAccountModel:!1,addLoading:!1,addAccountRules:{phone:[{required:!0,message:"注册手机号为必填项",trigger:"blur"}]},addAccount:{icon:"",status:1,identityCardsFrontImg:"",identityCardsBackImg:""},updateAccountModel:!1,updateLoading:!1,updateAccountRules:{phone:[{required:!0,message:"注册手机号为必填项",trigger:"blur"}]},updateAccount:{},deleteAccount:{},roleList:[],accountList:[],accountColumns:[{title:"序号",minWidth:100,align:"center",render:function(e,a){return e("span",a.index+(t.params.currentPage-1)*t.params.pageSize+t.params.startNum)}},{title:"账户id",minWidth:100,key:"accountId",align:"center"},{title:"注册手机号",minWidth:100,key:"phone",align:"center"},{title:"邀请码",minWidth:100,align:"center",render:function(e,a){return e("span",[a.row.inviteCode,e("Button",{props:{type:"primary",size:"small"},on:{click:function(){t.updateInviteCode(a.row)}}},"更新")])}},{title:"姓名",minWidth:100,key:"realname",align:"center"},{title:"角色名",minWidth:100,align:"center",render:function(t,e){return t("span",e.row.role.name)}},{title:"状态",minWidth:100,key:"status",align:"center",render:function(e,a){var s="";return t.statusList.forEach(function(t){t.id==a.row.status&&(s=t.value)}),e("span",s)}},{title:"创建时间",minWidth:100,key:"createDate",sortable:!0,align:"center"},{title:"最后登陆时间",minWidth:100,key:"loginDate",sortable:!0,align:"center"},{title:"操作",minWidth:200,key:"action",align:"center",render:function(e,a){var s="正常",n="success";2==a.row.status&&(s="已禁用",n="error");var o=e("Button",{props:{type:n,size:"small"},style:{margin:"2px"},on:{click:function(){1==a.row.status?a.row.status=2:a.row.status=1,t.updateAccount=a.row,t.changeStatus(a.row)}}},s),c=(e("Button",{props:{type:"primary",size:"small"},style:{margin:"2px"},on:{click:function(){t.update(a.row)}}},"编辑"),e("Button",{props:{type:"error",size:"small"},style:{margin:"2px"},on:{click:function(){t.delete(a.row)}}},"删除"));return e("Button",{props:{type:"error",size:"small"},style:{margin:"2px"},on:{click:function(){t.loginout(a.row)}}},"登录退出"),e("div",""),e("div",[e("div",[o,,c])])}}]}},methods:{search:function(){this.params.currentPage=1,this.params.pageNum=1,this.getList()},selectPage:function(t){this.params.currentPage=t,this.params.pageNum=(this.params.currentPage-1)*this.params.pageSize+this.params.startNum,this.getList()},onPageSizeChange:function(t){this.params.pageSize=t,this.selectPage(1)},getRoleList:function(){var t=this;this.params.pageSize=1e4,this.axiosbusiness.getList(this,{countUrl:"/role/count",listUrl:"/role/list",data:"roleList",success:function(){for(var e=t.roleList.length,a=0;a<e;a++)"/main/account/managerAccount"==t.routerPath&&"超级管理员"!=t.roleList[a].name&&"普通管理员"!=t.roleList[a].name&&(t.roleList.splice(a,1),e--,a--);t.roleList[0]&&t.roleList[0].roleId&&(t.params.roleId=t.roleList[0].roleId),t.getList(10)}},this.params)},getList:function(){this.axiosbusiness.getList(this,{countUrl:"/account/count",listUrl:"/account/list",data:"accountList",success:function(){}},this.params)},add:function(t){this.addAccountModel=!0,this.addAccount={status:1,roleId:this.roleList[0].roleId}},addCancel:function(){this.addLoading||(this.addAccountModel=!1,this.$refs.addAccount.resetFields())},addSure:function(){this.axiosbusiness.add(this,{ref:"addAccount",url:"/account/add",requestObject:"addAccount",loading:"addLoading",showModel:"addAccountModel"})},update:function(t){this.updateAccountModel=!0,this.updateAccount.accountId=t.accountId,this.axiosbusiness.get(this,{url:"/account/"+t.accountId,list:"updateAccount",success:function(){}})},updateCancel:function(){this.updateLoading||(this.updateAccountModel=!1,this.$refs.updateAccount.resetFields())},updateSure:function(){delete this.updateAccount.role,this.axiosbusiness.update(this,{ref:"updateAccount",url:"/account/update",requestObject:"updateAccount",loading:"updateLoading",showModel:"updateAccountModel"})},delete:function(t){this.deleteAccount={accountId:t.accountId},this.axiosbusiness.delete(this,{url:"/account/delete",requestObject:"deleteAccount"})},loginout:function(t){this.loginoutAccount={accountId:t.accountId},this.axiosbusiness.loginout(this,{url:"/account/loginout",requestObject:"loginoutAccount"})},updateInviteCode:function(t){var e=this,a="?accountId="+this.business.getAccount().accountId;a+="&targetAccountId="+t.accountId,this.$Modal.confirm({title:"更新邀请码",content:"确认更新邀请码吗？",onOk:function(){e.axiosbusiness.get(e,{url:"/account/updateInviteCode"+a,success:function(a){e.$Message.success("更新成功"),t.inviteCode=a.data.data[0].inviteCode}})},onCancel:function(){e.$Message.info("取消")}})},changeStatus:function(t){var e=this;this.updateAccount=t,delete this.updateAccount.role,this.axios({method:"post",url:"/account/update",withCredentials:!0,data:this.Qs.stringify(this.updateAccount)}).then(function(t){e.loading=!1,200===t.data.code?e.$Message.success(t.data.msg):(e.$Message.error(t.data.msg),e.loading=!1)}).catch(function(t){e.loading=!1,e.$Message.error("系统异常")})}},watch:{$route:function(t,e){this.routerPath=this.$route.path,this.getRoleList()}},created:function(){this.getRoleList()},mounted:function(){}},s,!1,null,null,null);e.default=n.exports}});
//# sourceMappingURL=22.c61e477c6b5911ddae47.js.map